# redis如何实现持久化缓存

Redis有两种持久化的方式：快照（RDB文件）和追加式文件（AOF文件）

> RDB (Redis DataBase)

在指定的时间内将内存的数据快照写入磁盘，也就是行话讲的snapshot快照，他恢复时是将快照文件直接读到内存里的。

Redis会单独fork一个子进程来实现持久化，会将数据写入到一个临时文件中，待持久化过程都结束了，再用这个文件替换上次持久化的文件。整个过程，主进程是不进行任何IO操作的 这就确保了极高的性能，如果需要进行大规模的数据恢复，且对数据恢复的完整性不是很敏感，那RDB方式要比AOF方式更加的高效。RDF的缺点是最后一次持久化的数据可能丢失。


> AOF(Append Only File)

以日志的形式来记录每个写操作，将Redis执行过的所有写指令记录下来（读操作不记录）只允许追加文件但不可以改文件，redis启动之初会读取该文件重构建数据，也就是【重放】。换言之，redis重启的话会根据日志文件的内容将写指令从前到后执行一次以完成数据恢复工作。

